<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí¨ –°–ø–∏—Å–æ–∫ –ü–í–ó - –ü–í–ó –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</title>
    <link rel="stylesheet" href="/assets/styles/main.css">
</head>
<body>
    <div class="app">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <nav class="sidebar">
            <div class="brand">
                <div class="comment-icon">üí¨</div>
                <div>–ü–í–ó –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</div>
            </div>
            <div class="nav">
                <a href="/main" class="nav-item">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/users" class="nav-item">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
                <a href="/roles" class="nav-item">–†–æ–ª–∏</a>
                <a href="/pvz" class="nav-item active">–°–ø–∏—Å–æ–∫ –ü–í–ó</a>
                <a href="/settings" class="nav-item">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            </div>
            <div class="sidebar-bottom">
                <button class="theme-toggle" id="themeToggle">
                    <span class="theme-toggle-icon">üåô</span>
                    <span class="theme-toggle-text">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                </button>
                <div class="user-info" id="userInfo">
                    <span class="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                    <span class="user-role"></span>
                </div>
                <button class="nav-item logout-btn" id="btnLogout">–í—ã–π—Ç–∏</button>
            </div>
        </nav>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="content">
            <div class="page-header">
                <h2>–°–ø–∏—Å–æ–∫ –ü–í–ó</h2>
                <div class="page-actions">
                    <button class="btn btn-secondary" id="btnTableSettings">
                        <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
                    </button>
                    <button class="btn btn-primary" id="btnRefresh">
                        <span>üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å
                    </button>
                </div>
            </div>

            <!-- –§–∏–ª—å—Ç—Ä—ã -->
            <div class="filters-container">
                <div class="filters-row">
                    <div class="filter-group filter-pvz-id">
                        <label for="pvzIdFilter">ID –ü–í–ó:</label>
                        <input type="text" id="pvzIdFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ ID...">
                    </div>
                    
                    <div class="filter-group filter-region">
                        <label for="regionSearchInput">–†–µ–≥–∏–æ–Ω:</label>
                        <input type="text" id="regionSearchInput" placeholder="–ü–æ–∏—Å–∫ —Ä–µ–≥–∏–æ–Ω–∞...">
                        <div id="regionSuggestions" class="suggestions-list"></div>
                    </div>
                    
                    <div class="filter-group filter-address">
                        <label for="addressFilter">–ê–¥—Ä–µ—Å:</label>
                        <input type="text" id="addressFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É...">
                    </div>
                    
                    <div class="filter-group filter-company">
                        <label for="companyFilter">–ö–æ–º–ø–∞–Ω–∏—è:</label>
                        <input type="text" id="companyFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏...">
                    </div>
                    
                    <div class="filter-actions">
                        <button class="btn btn-secondary" id="btnClearFilters">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                        <button class="btn btn-primary" id="btnExport">–≠–∫—Å–ø–æ—Ä—Ç</button>
                    </div>
                </div>
                
                <div id="selectedRegions" class="selected-regions"></div>
            </div>

            <!-- –¢–∞–±–ª–∏—Ü–∞ -->
            <div class="table-container">
                <table class="pvz-table" id="pvzTable">
                        <thead id="tableHead">
                            <tr>
                                <th data-column="pvz_id" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–í–Ω–µ—à–Ω–∏–π<br>ID –ü–í–ó</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="region" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–†–µ–≥–∏–æ–Ω</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="address" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ê–¥—Ä–µ—Å</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="service_name" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ<br>—Å–µ—Ä–≤–∏—Å–∞</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="status_date" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–î–∞—Ç–∞<br>—Å—Ç–∞—Ç—É—Å–∞</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="status_name" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ<br>—Å—Ç–∞—Ç—É—Å–∞</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="company_name" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ<br>–∫–æ–º–ø–∞–Ω–∏–∏</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="transaction_date" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–î–∞—Ç–∞<br>—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="transaction_amount" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–°—É–º–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏,<br>—Ä—É–±</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="phone" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–¢–µ–ª–µ—Ñ–æ–Ω</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="postal_code" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ò–Ω–¥–µ–∫—Å</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="fitting_room" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ü—Ä–∏–º–µ—Ä–æ—á–Ω–∞—è</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="last_comment" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="comment_author" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ö—Ç–æ<br>–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                                <th data-column="comment_date" class="sortable" data-sort="none">
                                    <span class="column-content">
                                        <span class="column-title">–ö–æ–≥–¥–∞<br>–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª</span>
                                        <span class="sort-indicator"></span>
                                    </span>
                                    <div class="resize-handle"></div>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <tr>
                                <td colspan="15" style="text-align: center; color: var(--text-muted);">
                                    –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
                                </td>
                            </tr>
                        </tbody>
                </table>
            </div>

            <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
            <div class="pagination">
                <div class="pagination-info">
                    <span id="paginationInfo">–ü–æ–∫–∞–∑–∞–Ω–æ 1-20 –∏–∑ 100</span>
                </div>
                <div class="pagination-controls">
                    <button class="pagination-btn" id="btnFirstPage" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"/>
                        </svg>
                    </button>
                    <button class="pagination-btn" id="btnPrevPage" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                        </svg>
                    </button>
                    <div class="pagination-pages" id="paginationPages">
                        <button class="pagination-page active">1</button>
                    </div>
                    <button class="pagination-btn" id="btnNextPage" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                        </svg>
                    </button>
                    <button class="pagination-btn" id="btnLastPage" disabled>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ç–∞–±–ª–∏—Ü—ã -->
    <div class="overlay" id="tableSettingsModal">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h3 class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã</h3>
                <button class="close" id="closeTableSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4>–í–∏–¥–∏–º—ã–µ —Å—Ç–æ–ª–±—Ü—ã</h4>
                    <div class="column-settings" id="columnSettings">
                        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                <div class="settings-actions">
                    <button class="btn btn-secondary" id="btnResetSettings">–í–∏–¥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</button>
                    <button class="btn btn-primary" id="btnSaveSettings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
    <div id="commentsModal" class="comments-modal">
      <div class="comments-modal-content">
        <div class="comments-modal-header">
          <h3 class="comments-modal-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
          <button class="comments-modal-close" id="closeCommentsModal">&times;</button>
        </div>
        <div class="comments-modal-body">
          <form class="comments-form" id="commentsForm">
            <div class="comments-form-group">
              <label class="comments-form-label" for="newComment">–ù–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
              <textarea 
                class="comments-form-textarea" 
                id="newComment" 
                name="comment" 
                placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."
                required
              ></textarea>
            </div>
            <div class="comments-form-actions">
              <button type="button" class="btn btn-secondary" id="cancelComment">–û—Ç–º–µ–Ω–∞</button>
              <button type="submit" class="btn btn-primary" id="saveComment">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
          </form>
          
          <div class="comments-list">
            <div class="comments-list-header">–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:</div>
            <div class="comments-list-container" id="commentsList">
              <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π -->
    <script src="/modules/shared/api.js"></script>
    <script src="/modules/shared/utils.js"></script>
    <script src="/modules/shared/theme.js"></script>
    <script src="/modules/shared/navigation.js"></script>
    <script src="/modules/auth/auth.js"></script>
    <script src="/modules/pvz/pvz.js"></script>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ü–í–ó –∑–∞–≥—Ä—É–∂–µ–Ω–∞');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
            if (!apiClient.checkAuthAndRedirect()) {
                return;
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
            await window.navigationModule.init();

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–¥—É–ª—å –ü–í–ó
            if (window.pvzModule) {
                await window.pvzModule.init();
            }

            console.log('üìÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ü–í–ó –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ');
        });
    </script>
</body>
</html>
